{
  "mitigation": "Currently, there is not a known mitigation except avoiding the functionality of using ansible_facts as a subkey.",
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Ansible Engine 2",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ansible_engine:2"
    },
    {
      "product_name": "Red Hat Ansible Tower 3",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ansible_tower:3"
    },
    {
      "product_name": "Red Hat Ceph Storage 2",
      "fix_state": "Out of support scope",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:2"
    },
    {
      "product_name": "Red Hat Ceph Storage 3",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:ceph_storage:3"
    },
    {
      "product_name": "Red Hat OpenStack Platform 10 (Newton)",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:openstack:10"
    },
    {
      "product_name": "Red Hat OpenStack Platform 13 (Queens)",
      "fix_state": "Affected",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:openstack:13"
    },
    {
      "product_name": "Red Hat Storage 3",
      "fix_state": "Will not fix",
      "package_name": "ansible",
      "cpe": "cpe:/a:redhat:storage:3"
    }
  ],
  "threat_severity": "Important",
  "public_date": "2020-03-23T00:00:00Z",
  "bugzilla": {
    "description": "CVE-2020-10684 Ansible: code injection when using ansible_facts as a subkey",
    "id": "1815519",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1815519"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.9",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:N/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-94-\u003eCWE-250-\u003eCWE-362",
  "statement": "Ansible Engine 2.7.16, 2.8.10, and 2.9.6 as well as previous versions are affected.\nAnsible Tower 3.4.5, 3.5.5 and 3.6.3 as well as previous versions are affected.\nRed Hat Gluster Storage and Red Hat Ceph Storage no longer maintains their own version of Ansible. The fix will be consumed from core Ansible. But we still ship ansible separately for ceph ubuntu.",
  "acknowledgement": "Red Hat would like to thank Damien Aumaitre (Quarkslab) and Nicolas Surbayrole (Quarkslab) for reporting this issue.",
  "name": "CVE-2020-10684",
  "document_distribution": "",
  "details": [
    "A flaw was found in Ansible Engine, all versions 2.7.x, 2.8.x and 2.9.x prior to 2.7.17, 2.8.9 and 2.9.6 respectively, when using ansible_facts as a subkey of itself and promoting it to a variable when inject is enabled, overwriting the ansible_facts after the clean. An attacker could take advantage of this by altering the ansible_facts, such as ansible_hosts, users and any other key data which would lead into privilege escalation or code injection.",
    "A flaw was found in the Ansible Engine. When using ansible_facts as a subkey of itself, and promoting it to a variable when injecting is enabled, overwriting the ansible_facts after the clean, an attacker could take advantage of this by altering the ansible_facts leading to privilege escalation or code injection. The highest threat from this vulnerability are to data integrity and system availability."
  ],
  "references": null
}