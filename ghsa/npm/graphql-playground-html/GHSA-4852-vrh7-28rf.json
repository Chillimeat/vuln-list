{
  "Severity": "HIGH",
  "UpdatedAt": "2020-06-08T20:27:55Z",
  "Package": {
    "Ecosystem": "NPM",
    "Name": "graphql-playground-html"
  },
  "Advisory": {
    "DatabaseId": 2153,
    "Id": "MDE2OlNlY3VyaXR5QWR2aXNvcnlHSFNBLTQ4NTItdnJoNy0yOHJm",
    "GhsaId": "GHSA-4852-vrh7-28rf",
    "References": [
      {
        "Url": "https://github.com/prisma-labs/graphql-playground/security/advisories/GHSA-4852-vrh7-28rf"
      },
      {
        "Url": "https://nvd.nist.gov/vuln/detail/CVE-2020-4038"
      },
      {
        "Url": "https://github.com/advisories/GHSA-4852-vrh7-28rf"
      }
    ],
    "Identifiers": [
      {
        "Type": "GHSA",
        "Value": "GHSA-4852-vrh7-28rf"
      },
      {
        "Type": "CVE",
        "Value": "CVE-2020-4038"
      }
    ],
    "Description": "### Impact\n\n**directly impacted:**\n\n- `graphql-playground-html` - all unsanitized user input for `renderPlaygroundPage()`\n\n**all of our consuming packages** of `graphql-playground-html` are impacted:\n\n- `graphql-playground-middleware-express` - unsanitized user input to `expressPlayground()`\n- `graphql-playground-middleware-koa` - unsanitized user input to `koaPlayground()`\n- `graphql-playground-middleware-lambda` - unsanitized user input to `lambdaPlayground()`\n- `graphql-playground-middleware-hapi` - unsanitized user input to `hapiPlayground()`\n\nas well as ***any other packages*** that use these methods with unsanitized user input.\n\n**not impacted:**\n\n- `graphql-playground-electron` - uses `renderPlaygroundPage()` statically for a webpack build for electron bundle, no dynamic user input\n- `graphql-playground-react` - usage of the component directly in a react application\n\n### Patches\n_Has the problem been patched? What versions should users upgrade to?_\n\n### Workarounds\n\nEnsure you properly sanitize *all* user input for options you use for whatever function to initialize GraphQLPlayground:\n\nfor example, with `graphql-playground-html` and express:\n\n```js\nconst { sanitizeUrl } = require('@braintree/sanitize-url');\n\nconst qs = require('querystringify');\n\nconst { renderPlaygroundPage } = require('graphql-playground-html');\n\nmodule.exports = (req, res, next) =\u003e {\n\tconst { endpoint } = qs.parse(req.url)\n\tres.html(renderPlaygroundPage({endpoint: sanitizeUrl(endpoint) })).status(200)\n\tnext()\n}\n```\n\nor, with `graphql-playground-express`:\n\n```js\nconst { expressPlayground } = require('graphql-playground-middleware-express');\nconst { sanitizeUrl } = require('@braintree/sanitize-url');\n\nconst qs = require('querystringify');\n\nconst { renderPlaygroundPage } = require('graphql-playground-html');\n\nmodule.exports = (req, res, next) =\u003e {\n\tconst { endpoint } = qs.parse(req.url)\n\tres.html(expressPlayground({endpoint: sanitizeUrl(endpoint) })).status(200)\n\tnext()\n}\n```\n\n### References\n_Are there any links users can visit to find out more?_\n\n### Credits\n\nMasato Kinugawa of Cure53\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in [graphql-playground](https://github.com/prisma-labs/graphql-playground/issues/new/choose)\n* Email us at [rikki.schulte@gmail.com](mailto:rikki.schulte@gmail.com)",
    "Origin": "UNSPECIFIED",
    "PublishedAt": "2020-06-09T00:24:57Z",
    "Severity": "HIGH",
    "Summary": "Reflected XSS in GraphQL Playground",
    "UpdatedAt": "2020-06-09T00:24:57Z",
    "WithdrawnAt": ""
  },
  "Versions": [
    {
      "FirstPatchedVersion": {
        "Identifier": "1.6.22"
      },
      "VulnerableVersionRange": "\u003c 1.6.22"
    }
  ]
}